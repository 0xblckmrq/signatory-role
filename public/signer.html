<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Sign Message</title>
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.8.1/dist/ethers.min.js"></script>
</head>
<body>
<h2>Sign Your Bot Message</h2>
<input type="text" id="msg" placeholder="Paste challenge here" size="80">
<button onclick="sign()">Sign Message</button>
<p id="signature"></p>

<script>
async function sign() {
  const challenge = document.getElementById("msg").value;
  if (!challenge) return alert("Paste the challenge message!");

  // Check for MetaMask
  let provider;
  if (window.ethereum) {
    provider = new ethers.BrowserProvider(window.ethereum);
    await window.ethereum.request({ method: 'eth_requestAccounts' });
  } else {
    // WalletConnect fallback
    const wcProvider = new WalletConnectProvider.default({
      infuraId: "YOUR_INFURA_KEY" // from Render env
    });
    await wcProvider.enable();
    provider = new ethers.BrowserProvider(wcProvider);
  }

  const signer = await provider.getSigner();
  try {
    const sig = await signer.signMessage(challenge);
    document.getElementById("signature").innerText = sig;
  } catch(e) {
    alert(e.message);
  }
}
</script>
</body>
</html>
